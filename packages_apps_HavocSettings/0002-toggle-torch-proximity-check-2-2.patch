From ff3a8997d0b9b276ec934e2d634a9392a51188e9 Mon Sep 17 00:00:00 2001
From: Kazakov Stepan <ksrt12group@gmail.com>
Date: Tue, 22 Jan 2019 12:31:50 +0300
Subject: [PATCH 2/2] toggle torch proximity check [2/2]

Signed-off-by: Kazakov Stepan <ksrt12group@gmail.com>
---
 res/values-ru/havoc_strings.xml    | 18 +++++++++++++-----
 res/values/havoc_strings.xml       |  2 ++
 res/xml/havoc_settings_buttons.xml |  7 +++++++
 3 files changed, 22 insertions(+), 5 deletions(-)

diff --git a/res/values-ru/havoc_strings.xml b/res/values-ru/havoc_strings.xml
index a787886..1631d75 100644
--- a/res/values-ru/havoc_strings.xml
+++ b/res/values-ru/havoc_strings.xml
@@ -613,8 +613,8 @@
     <string name="qs_footer_warnings_title">Предупреждение о VPN</string>
     <string name="qs_footer_warnings_summary">Показывать предупреждение, когда сеть контролируется сторонними приложениями или VPN</string>
     <string name="hardware_keys_power_category">Кнопка питания</string>
-    <string name="power_end_call_title">Завершить вызов</string>
-    <string name="power_end_call_summary">Завершить текущий вызов нажатием кнопки питания</string>
+    <string name="power_end_call_title">Завершение вызова</string>
+    <string name="power_end_call_summary">Завершение текущего вызова нажатием кнопки питания</string>
     <!-- MediaScanner behavior on boot -->
     <string name="media_scanner_on_boot_title">Поведение медиа-сканера</string>
     <string name="media_scanner_on_boot_enabled">Сканировать медиа</string>
@@ -1358,10 +1358,18 @@
     <string name="keyguard_multiuser_switch_title">Переключение пользователей</string>
     <string name="keyguard_multiuser_switch_summary">Иконка пользователя в строке состояния</string>
     <!-- Torch Power button gestures -->
-    <string name="power_button_torch_gesture_title">Фонарик при выключенном экране</string>
+    <string name="power_button_torch_gesture_title">Включение фонарика нажатием кнопки питания</string>
     <string name="power_button_torch_gesture_none">Отключено</string>
-    <string name="power_button_torch_gesture_dt">Двойное нажатие кнопки питания</string>
-    <string name="power_button_torch_gesture_lp">Долгое нажатие кнопки питания</string>
+    <string name="power_button_torch_gesture_dt">Двойное нажатие</string>
+    <string name="power_button_torch_gesture_lp">Долгое нажатие</string>
+    <string name="power_button_torch_check_title">Проверка датчика приближения</string>
+    <string name="power_button_torch_check_desc">Проверять датчик приближения перед ключением фонарика</string>
+    <string name="torch_long_press_power_timeout_title">Автоматическое выключение фонарика</string>
+    <string name="torch_long_press_power_timeout_never">Никогда</string>
+    <string name="torch_long_press_power_timeout_1min">1 минутa</string>
+    <string name="torch_long_press_power_timeout_2min">2 минуты</string>
+    <string name="torch_long_press_power_timeout_5min">5 минут</string>
+    <string name="torch_long_press_power_timeout_10min">10 минут</string>
     <!-- Adaptive icon shape -->
     <string name="icon_shape_title">Форма иконок приложений</string>
     <string name="icon_shape_system_default">По умолчанию (системная)</string>
diff --git a/res/values/havoc_strings.xml b/res/values/havoc_strings.xml
index b74bc2c..b7ddd7c 100644
--- a/res/values/havoc_strings.xml
+++ b/res/values/havoc_strings.xml
@@ -700,6 +700,8 @@
     <string name="qs_footer_warnings_summary">Display a warning when network is monitored by external apps or vpn</string>
 
     <string name="hardware_keys_power_category">Power Button</string>
+    <string name="power_button_torch_check_title">Proximity check for torch</string>
+    <string name="power_button_torch_check_desc">Check proximity sensor before turning on the flashlight</string>
     <string name="power_end_call_title">End call</string>
     <string name="power_end_call_summary">End the current call by pressing the power button</string>
 
diff --git a/res/xml/havoc_settings_buttons.xml b/res/xml/havoc_settings_buttons.xml
index 73d2da3..4f874fb 100644
--- a/res/xml/havoc_settings_buttons.xml
+++ b/res/xml/havoc_settings_buttons.xml
@@ -63,6 +63,13 @@
             android:entries="@array/power_button_torch_gesture_entries"
             android:entryValues="@array/power_button_torch_gesture_values" />
 
+        <com.havoc.support.preferences.SystemSettingSwitchPreference
+            android:key="power_button_torch_check"
+            android:title="@string/power_button_torch_check_title"
+            android:summary="@string/power_button_torch_check_desc"
+            android:dependency="torch_power_button_gesture"
+            android:defaultValue="false" />
+
     </PreferenceCategory>
 
     <PreferenceCategory
-- 
2.20.1

