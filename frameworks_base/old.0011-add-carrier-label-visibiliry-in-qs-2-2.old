From a8f96ba6dd20ac92d7c9147ac7fa32d915c5a105 Mon Sep 17 00:00:00 2001
From: Kazakov Stepan <ksrt12group@gmail.com>
Date: Fri, 12 Apr 2019 23:44:38 +0300
Subject: [PATCH] add carrier label visibiliry in qs [2/2]

Signed-off-by: Kazakov Stepan <ksrt12group@gmail.com>
---
 core/java/android/provider/Settings.java              |  7 +++++++
 .../src/com/android/systemui/qs/QSFooterImpl.java     | 11 ++++++++++-
 2 files changed, 17 insertions(+), 1 deletion(-)

diff --git a/core/java/android/provider/Settings.java b/core/java/android/provider/Settings.java
index 7063dc9a0b09..0c0df5431a6a 100644
--- a/core/java/android/provider/Settings.java
+++ b/core/java/android/provider/Settings.java
@@ -5561,6 +5561,13 @@ public final class Settings {
          */
         public static final String SYSTEMUI_RECENTS_MEM_DISPLAY = "systemui_recents_mem_display";
 
+        /**
+         * Show Carrier lable in QS Footer
+         *
+         * @hide
+         */
+        public static final String QS_FOOTER_SHOW_CARRIER = "qs_footer_show_carrier";
+
         /**
          * Show Settings icon in QS Footer
          *
diff --git a/packages/SystemUI/src/com/android/systemui/qs/QSFooterImpl.java b/packages/SystemUI/src/com/android/systemui/qs/QSFooterImpl.java
index 91f7250171dd..dac4d6d33c70 100644
--- a/packages/SystemUI/src/com/android/systemui/qs/QSFooterImpl.java
+++ b/packages/SystemUI/src/com/android/systemui/qs/QSFooterImpl.java
@@ -297,6 +297,10 @@ public class QSFooterImpl extends FrameLayout implements QSFooter,
     }
 
     private void updateVisibilities() {
+        mMobileGroup.setVisibility(isCarrierEnabled() ? View.VISIBLE : View.GONE);
+        mMobileSignal.setVisibility(isCarrierEnabled() ? View.VISIBLE : View.GONE);
+        mMobileRoaming.setVisibility(isCarrierEnabled() ? View.VISIBLE : View.GONE);
+        mCarrierText.setVisibility(isCarrierEnabled() ? View.VISIBLE : View.GONE);
         mSettingsContainer.setVisibility(!isSettingsEnabled() ? View.GONE : View.VISIBLE);
         mSettingsButton.setVisibility(isSettingsEnabled() ? View.VISIBLE : View.GONE);
         final boolean isDemo = UserManager.isDeviceInDemoMode(mContext);
@@ -355,6 +359,11 @@ public class QSFooterImpl extends FrameLayout implements QSFooter,
         }
     }
 
+    public boolean isCarrierEnabled() {
+        return Settings.System.getInt(mContext.getContentResolver(),
+            Settings.System.QS_FOOTER_SHOW_CARRIER, 1) == 1;
+    }
+
     public boolean isSettingsEnabled() {
         return Settings.System.getInt(mContext.getContentResolver(),
             Settings.System.QS_FOOTER_SHOW_SETTINGS, 1) == 1;
@@ -362,7 +371,7 @@ public class QSFooterImpl extends FrameLayout implements QSFooter,
 
     public boolean isServicesEnabled() {
         return Settings.System.getInt(mContext.getContentResolver(),
-            Settings.System.QS_FOOTER_SHOW_SERVICES, 0) == 1;
+            Settings.System.QS_FOOTER_SHOW_SERVICES, 1) == 1;
     }
 
     public boolean isEditEnabled() {
-- 
2.20.1

